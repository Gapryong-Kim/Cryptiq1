<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>The Cipher Lab ‚Äî Tools, Posts & Codebreaking</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <style>
    /* === DARK THEME DEFAULT === */
    :root {
      --accent: #00ffd5;
      --bg: #0b0b0b;
      --text: #f0f0f0;
      --subtext: #bcbcbc;
      --panel: #1a1a1a;
      --border: rgba(255,255,255,0.08);
    }

    /* === LIGHT THEME OVERRIDES === */
    html[data-theme="light"] {
      --accent: #00b3a0;
      --bg: #f9f9fb;
      --text: #111;
      --subtext: #555;
      --panel: #f3f3f3;
      --border: rgba(0,0,0,0.08);
    }

    /* === BASE LAYOUT === */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      color: var(--text);
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      flex-direction: column;
      transition: background 0.4s ease, color 0.4s ease;
      overflow-x: hidden;
      overflow-y: auto;
    }

    @media (min-width: 900px) {
      ::-webkit-scrollbar { width: 0; background: transparent; }
      html { scrollbar-width: none; -ms-overflow-style: none; }
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: stretch;
    }

    /* === HERO (FIXED) === */
    .hero {
  display: flex;
  align-items: center;
  justify-content: space-between;

  /* FIXED: don‚Äôt collapse behind nav */
  min-height: 70vh;

  width: 100vw;
  padding: 0 8%;
  padding-top: 22vh;
  padding-bottom: 10vh;

  background: linear-gradient(180deg, var(--bg) 0%, var(--panel) 100%);
  gap: 60px;
  box-sizing: border-box;

  opacity: 0;
  animation: fadeIn 1.2s ease forwards;
  transition: background 0.4s ease;
}


    .hero-text {
      flex: 1;
      max-width: 540px;
      animation: slideInLeft 1.4s ease forwards;
      opacity: 0;
    }

    .hero-text h1 {
      font-size: 3.2rem;
      font-weight: 800;
      line-height: 1.15;
      margin: 0 0 22px;
      color: var(--text);
    }

    .hero-text h1 span {
      color: var(--accent);
    }

    .hero-text p {
      font-size: 1.1rem;
      color: var(--subtext);
      line-height: 1.6;
      margin-bottom: 36px;
    }

    .cta {
      background: var(--accent);
      color: #0f0f0f;
      border: none;
      border-radius: 8px;
      padding: 14px 34px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .cta:hover {
      background: #00e6c2;
      transform: scale(1.05);
    }

    /* === CIPHER BOX === */
    .hero-code {
      flex: 1;
      display: flex;
      justify-content: center;
      animation: slideInRight 1.4s ease forwards;
      opacity: 0;
    }

    .cipher-box {
      width: 520px;
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 32px;
      box-shadow: 0 0 50px rgba(0,255,213,0.08), 0 10px 35px rgba(0,0,0,0.4);
      font-family: "Consolas", monospace;
      animation: pulseGlow 5s ease-in-out infinite;
    }

    .cipher-header { color: var(--accent); font-weight: bold; margin-bottom: 8px; }
    .cipher-label { color: var(--subtext); }

    #cipher-output {
      color: var(--accent);
      font-weight: 600;
      letter-spacing: 1.5px;
    }

    /* === FIRST TIME SECTION === */
    .first-time {
      width: 100%;
      padding: 120px 0 130px;
      background: linear-gradient(180deg, var(--panel) 0%, var(--bg) 100%);
      display: flex;
      justify-content: center;
    }

    .ft-container {
      width: min(1100px, 90%);
      text-align: center;
    }

    .ft-heading {
      font-size: 2.3rem;
      font-weight: 800;
      margin-bottom: 14px;
    }

    .ft-subheading {
      color: var(--subtext);
      font-size: 1rem;
      max-width: 580px;
      margin: 0 auto 55px;
      line-height: 1.65;
    }

    .ft-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 28px;
    }

    .ft-card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 30px 26px;
      text-align: left;
      box-shadow: 0 0 20px rgba(0,0,0,0.30);
      transition: all 0.25s ease;
      display: flex;
      flex-direction: column;
      gap: 14px;
      text-decoration: none;
    }

    .ft-card h3 { color: var(--text); margin: 0; }
    .ft-card p { color: var(--subtext); margin: 0; }

    /* scramble: keep same width as final text */
   .scramble {
  display: inline-block;
  white-space: pre-wrap; /* FIX: allows wrapping while keeping intentional spacing */
}


    .footer-text {
      width: 100%;
      text-align: center;
      background: var(--panel);
      color: var(--subtext);
      padding: 35px 20px;
      font-size: 0.9rem;
      border-top: 1px solid var(--border);
    }

  
  /* Fix hero visibility & nav overlap */
main { padding-top: 90px; }

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-40px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(40px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
/* === NAVBAR OFFSET FIX === */

/* Declare real navbar height */
:root {
  --nav-height: 110px;   /* desktop */
}

@media (max-width: 900px) {
  :root {
    --nav-height: 140px; /* mobile hamburger layout (bigger) */
  }
}

/* Push content below navbar */
main {
  padding-top: var(--nav-height);
}

/* Ensure hero never slips under navbar */
.hero {
  margin-top: 300px;
}

  .scramble {
  display: inline-block;
  white-space: normal !important;   /* allow wrapping */
  overflow-wrap: break-word;        /* break long ‚Äúwords‚Äù */
  word-break: break-word;           /* extra safety */
}

  /* === New Here Cards ‚Äî Accent Hover Border === */
.ft-card {
  position: relative;
  transition: border-color 0.25s ease, box-shadow 0.25s ease, transform 0.2s ease;
}

.ft-card:hover {
  border-color: var(--accent);
  transform: translateY(-3px);
}

  </style>
</head>

<body>

  {% include 'base_nav.html' %}

  <main>

    <!-- HERO FIXED & RESTORED -->
    <section class="hero">
      <div class="hero-text">
        <h1>Discover. <span>Decrypt.</span><br>Explore The Cipher Lab.</h1>

        <p>
          The Cipher Lab is your all-in-one platform for exploring classical ciphers,
          analysing cryptographic patterns, and sharing ideas through interactive tools and community posts.
        </p>

        <a href="{{ url_for('breaker') }}">
          <button class="cta">Explore Tools</button>
        </a>
      </div>

      <div class="hero-code">
        <div class="cipher-box">
          <div class="cipher-header">Caesar Cipher Decryption</div>

          <div class="cipher-line">
            <span class="cipher-label">Ciphertext:</span>
            <span id="ciphertext">BJQHTRJ YT YMJ HNUMJW QFG!</span>
          </div>

          <div class="cipher-line">
            <span class="cipher-label">Key:</span> 5
          </div>

          <div class="cipher-line">
            <span class="cipher-label">Decrypted Text:</span>
            <span id="cipher-output"></span>
          </div>
        </div>
      </div>
    </section>

    <!-- FIRST TIME -->
    <section class="first-time">
      <div class="ft-container">

        <h2 class="ft-heading">New here? Start exploring.</h2>
        <p class="ft-subheading">Begin your cryptography journey with these essential tools and challenges.</p>

        <div class="ft-cards">

          <!-- Break a Cipher -->
          <a href="{{ url_for('breaker') }}" class="ft-card">
            <div class="ft-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2">
                <circle cx="11" cy="11" r="7"></circle>
                <line x1="16" y1="16" x2="22" y2="22"></line>
              </svg>
            </div>
            <h3><span class="scramble" data-final="Break a Cipher"></span></h3>
            <p><span class="scramble" data-final="Automatically detect and crack classical ciphers with one click."></span></p>
          </a>

          <!-- Tools -->
          <a href="{{ url_for('tools') }}" class="ft-card">
            <div class="ft-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2">
                <rect x="3" y="7" width="18" height="13"></rect>
                <path d="M8 7V5h8v2"></path>
              </svg>
            </div>
            <h3><span class="scramble" data-final="Explore Tools"></span></h3>
            <p><span class="scramble" data-final="Use encoders, decoders, analysers and helper utilities."></span></p>
          </a>

          <!-- Weekly Challenge -->
          <a href="{{ url_for('weekly_page') }}" class="ft-card">
            <div class="ft-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2">
                <path d="M8 21h8"></path>
                <path d="M12 17v4"></path>
                <path d="M7 4h10v5a5 5 0 0 1-10 0V4z"></path>
                <path d="M4 4h3v2a3 3 0 0 1-3 3"></path>
                <path d="M20 4h-3v2a3 3 0 0 0 3 3"></path>
              </svg>
            </div>
            <h3><span class="scramble" data-final="Weekly Cipher Challenge"></span></h3>
            <p><span class="scramble" data-final="Compete globally and climb the leaderboard."></span></p>
          </a>

        </div>

      </div>
    </section>

    <p class="footer-text">¬© 2025 The Cipher Lab ‚Äî Tools. Posts. Community.</p>
  </main>
<script>
/* ===============================
   Caesar Cipher Typing Animation
================================ */
const ciphertext = "BJQHTRJ YT YMJ HNUMJW QFG!";
const shift = 5;
const output = document.getElementById("cipher-output");

function caesarDecrypt(char, shift) {
  const code = char.charCodeAt(0);
  if (code >= 65 && code <= 90)
    return String.fromCharCode(((code - 65 - shift + 26) % 26) + 65);
  if (code >= 97 && code <= 122)
    return String.fromCharCode(((code - 97 - shift + 26) % 26) + 97);
  return char;
}

let index = 0;
let decrypted = "";

function typeDecrypt() {
  if (index < ciphertext.length) {
    decrypted += caesarDecrypt(ciphertext[index], shift);
    output.textContent = decrypted;
    index++;
    setTimeout(typeDecrypt, 40);
  }
}

window.addEventListener("load", () => setTimeout(typeDecrypt, 1200));



/* ===============================
   Scramble ‚Üí Decrypt
   (Word-matched, Blue ‚Üí White)
================================ */

function randomChar() {
  const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789#%@&*";
  return chars[Math.floor(Math.random() * chars.length)];
}

function generateInitialState(final) {
  return [...final].map(ch => ch === " " ? " " : randomChar());
}

const targets = document.querySelectorAll(".scramble");

targets.forEach((el) => {
  const finalText = el.dataset.final;
  const length = finalText.length;

  let state = generateInitialState(finalText);

  // Build HTML structure with spans
  el.innerHTML = state
    .map((c, i) =>
      finalText[i] === " "
        ? " "
        : `<span data-index="${i}" style="color: var(--accent);">${c}</span>`
    )
    .join("");

  const spans = el.querySelectorAll("span");

  // Build reveal list (non-space positions)
  let revealOrder = [...Array(length).keys()].filter(i => finalText[i] !== " ");

  // Shuffle reveal order (Fisher-Yates)
  for (let i = revealOrder.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [revealOrder[i], revealOrder[j]] = [revealOrder[j], revealOrder[i]];
  }

  let idx = 0;

  function animate() {
    // Scramble all not-yet-revealed chars
    state.forEach((ch, i) => {
      if (finalText[i] !== " " && state[i] !== finalText[i]) {
        const span = el.querySelector(`span[data-index="${i}"]`);
        if (span) span.textContent = randomChar();
      }
    });

    // Reveal one character per frame
    if (idx < revealOrder.length) {
      const pos = revealOrder[idx];
      state[pos] = finalText[pos];

      const span = el.querySelector(`span[data-index="${pos}"]`);
      if (span) {
        span.textContent = finalText[pos];

        // üî• BLUE ‚Üí WHITE transition (permanent white)
        span.style.transition = "color 0.25s ease";
        span.style.color = "var(--text)";
      }

      idx++;
    }

    if (idx < revealOrder.length) {
      setTimeout(animate, 45 + Math.random() * 25);
    } else {
      // Ensure finished state is correct
      for (let i = 0; i < length; i++) {
        if (finalText[i] !== " ") {
          const span = el.querySelector(`span[data-index="${i}"]`);
          if (span) {
            span.textContent = finalText[i];
            span.style.color = "var(--text)"; // final white
          }
        }
      }
    }
  }

  // Only start when visible
  const observer = new IntersectionObserver(
    entries => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          animate();
          observer.unobserve(el);
        }
      });
    },
    { threshold: 0.25 }
  );

  observer.observe(el);
});
</script>



</body>
</html>
